要获得当前鼠标位置,请使用

```C#
Main.MouseScreen.X或Main.mouseX
Main.MouseScreen.Y或Main.mouseY
```

```C#
//通过检查ContainsPoint,确定玩家点击的位置是不是在ui内
            //然后把mouseInterface设置成true
            //以此防止点击ui时使用物品

            if(ContainsPoint(Main.MouseScreen))
            {
                Main.LocalPlayer.mouseInterface = true;
            }
```

```C#
//下面我们检查DragablePanel是否在底层矩形UIElement外面
            //且调整它的位置,使其在屏幕内

            var parentSpace = Parent.GetDimensions().ToRectangle();
            if (!GetDimensions().ToRectangle().Intersects(parentSpace))
            {
                Left.Pixels = Utils.Clamp(Left.Pixels, 0, parentSpace.Right - Width.Pixels);
                Top.Pixels = Utils.Clamp(Top.Pixels, 0, parentSpace.Bottom - Height.Pixels);
                Recalculate();
                //重新计算位置
            }
```

- 解释
    
    这段代码是 Terraria Modding 中用于处理 UI 元素位置的一部分。
    
    让我逐行解释：
    
    1. `var parentSpace = Parent.GetDimensions().ToRectangle();`：
        - `Parent` 是当前 UI 元素的父级元素，也就是包含当前 UI 元素的容器。
        - `GetDimensions()` 返回一个描述当前 UI 元素位置和尺寸的 `Rectangle` 对象。
        - `ToRectangle()` 将该 `Rectangle` 对象转换为一个矩形。
        - 最终，`parentSpace` 将包含当前 UI 元素的父级元素的位置和尺寸信息。
    2. `if (!GetDimensions().ToRectangle().Intersects(parentSpace))`：
        - `GetDimensions()` 返回描述当前 UI 元素位置和尺寸的 `Rectangle` 对象。
        - `ToRectangle()` 将其转换为矩形。
        - `Intersects(parentSpace)` 检查当前 UI 元素的矩形区域是否与父级元素的矩形区域相交。
        - `!` 取反操作，意味着如果两者没有相交，就执行下面的代码块。
    3. 下面是在两种情况下的处理：
        - `Left.Pixels = Utils.Clamp(Left.Pixels, 0, parentSpace.Right - Width.Pixels);`：
            - 这行代码将当前 UI 元素的左侧位置（以像素为单位）进行调整。
            - `Utils.Clamp` 用于确保值在指定的范围内，这里是将 `Left.Pixels` 限制在 `0` 和 `parentSpace.Right - Width.Pixels` 之间。
            - 这样做是为了确保 UI 元素不会超出父级元素的右边界。
        - `Top.Pixels = Utils.Clamp(Top.Pixels, 0, parentSpace.Bottom - Height.Pixels);`：
            - 这行代码将当前 UI 元素的顶部位置（以像素为单位）进行调整。
            - 同样，使用 `Utils.Clamp` 来确保值在指定的范围内，这里是将 `Top.Pixels` 限制在 `0` 和 `parentSpace.Bottom - Height.Pixels` 之间。
            - 这样做是为了确保 UI 元素不会超出父级元素的底部边界。
        - `Recalculate();`：
            - 这行代码重新计算 UI 元素的位置和尺寸，以确保调整后的位置生效。
    
    总的来说，这段代码的作用是检查当前 UI 元素是否超出了其父级元素的范围，如果超出了，则会调整其位置，使其保持在父级元素内部。这样可以确保 UI 元素不会超出屏幕显示范围，同时保持在合适的位置上。