误差

最小二乘法

最小二乘解

解的存在唯一性

找到这个解

列满秩与秩亏损

列满秩矩阵的最小二乘问题

用QR分解求解列满秩LS问题

实例

最小二乘法（ $least squares method$﻿）是一种数学优化方法

核心是通过**最小化误差的平方**寻找数据的最佳函数匹配

是一种逼近、拟合的思想

---

# 误差

$\delta_i = f(x_i)-y_i,\quad i=1,2,\cdots,m$

我们定义这个差为拟合函数 $f(x)$﻿在 $x_i$﻿处的**偏差**（**残差**）

为了让 $f(x)$﻿和给定数据尽可能地接近，我们可以采用“残差的平方和最小”作为判定标准

于是，我们需要使函数

$\sum_{i=1}^{m}(f(x_i)-y_i)^2$

达到最小值

这就是**最小二乘原则**，根据最小二乘原则确定拟合函数的方法称为最小二乘法

---

# 最小二乘法

一般来说，我们都是使用最小二乘法来**拟合函数**

我们可以得到一个有很多参量的函数，我们需要求得一组参量使得上面的误差达到最小值

例如，考虑多项式拟合，我们有一个 $n$﻿次多项式：

$f(x)=a_0+a_1x+a_2x^2+\cdots+a_nx^n$

来拟合一组数据点，即求解最小二乘问题

$\min_{a_0,a_1,\cdots,a_n}\sum_{i=1}^{m}(y_i-(a_0+a_1x_i+a_2x^2_i+\cdots+a_nx_i^n))^2$

即我们表现为矩阵形式：

[](https://www.notion.soundefined)

注意这个矩阵很像范德蒙行列式，但是这里的矩阵可以不是方的

  

给定矩阵 $A\in R^{m\times n}$﻿，向量 $b\in R^{m}$﻿，确定 $x^*\in R^n$﻿使得

$||Ax^* -b||^2_2=\min_{x\in R^{n}}||Ax-b||^2_2$

这就是最小二乘问题

[](https://www.notion.soundefined)

---

## 最小二乘解

## 解的存在唯一性

如果矩阵 $A\in R^{m\times n}$﻿， $m>n$﻿ , $b\in R^m$﻿,线性最小二乘问题 $\min_{x\in R^n}||Ax-b||^2_2$﻿的解总是存在的，而且解唯一的充分必要条件是

$null(A)={0}$

在这里 $null（A）$﻿表示矩阵 $A$﻿的零空间

  

这表示，只要矩阵 $A$﻿是一个窄矩阵（行数大于列数）（超定方程组），最小二乘问题有解

这还意味着矩阵 $A$﻿的秩是 $n$﻿， $A$﻿是列满秩的

---

## 找到这个解

如果矩阵 $A\in R^{m\times n}$﻿， $m>n$﻿ , $b\in R^m$﻿, $x$﻿是最小二乘问题 $\min_{x\in R^n}||Ax-b||^2_2$﻿的解当且仅当下面的式子成立：

$A^TAx=A^b$

我们称这种方法为**正则化方法**

---

# 列满秩与秩亏损

## 列满秩矩阵的最小二乘问题

给定一个列满秩矩阵 $A\in R^{m\times n},\quad m\ge n$﻿，我们记 $\varphi(x)=||Ax-b||^2_2$﻿，

为了求得这个函数的最小值，我们直接进行求梯度：

$\nabla \varphi(x)=0$

即

$A^TAx-A^Tb=0$

由于矩阵 $A$﻿列满秩，所以 $A^TA$﻿非奇异，于是

$x_{LS}=(A^TA)^{-1}A^Tb$

最小二乘问题 $\min_{x}\varphi(x)$﻿存在一个唯一的最小二乘解 $x_{LS}$﻿

  

我们称 $r_{LS}=b-Ax_{LS}$﻿为极小剩余

  

  

我们一般不使用这种方法求最小二乘解，一般要搭配 $QR$﻿分解来求解

---

## 用QR分解求解列满秩LS问题

记矩阵 $A$﻿的 $QR$﻿分解为 $A=QR$﻿，并且

$Q^TA=R=\begin{pmatrix}R_1\\0\end{pmatrix} \\ 其中R_1为n行，0为m-n行$

  

  

这里利用了 $Q$﻿作为正交阵不改变范数的特点

  

## 实例

[[实例 用最小二乘法拟合模型]]