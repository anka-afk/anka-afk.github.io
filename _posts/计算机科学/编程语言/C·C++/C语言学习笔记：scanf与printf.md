---
title: C语言学习笔记：scanf与printf
tags:
  - C语言
excerpt: C语言中两个可以接收不定量参数的神奇函数
toc: true
author: xeonds
date: '2021.10.27 10:44:29'
categories:
  - 计算机科学
  - 编程语言
  - C·C++
---

## 概览

这两个函数的原型都在`stdio.h`头文件中，分别如下：

```c
int scanf(const char * restrict format,...);
```

```c
// C99 前
int printf( const char *format, ... );
// C99 起
int printf( const char *restrict format, ... );
```

它们的参数列表中，第一个是格式控制字符串，包含了两种类型的对象：普通字符和转换说明；第二个及以后的参数是与格式化字符串一一对应的参数列表。

它们返回`int`类型的数据，表示成功处理的参数数量，下面分别详细说明。

## scanf

scanf函数返回成功读入的数据项数，读入数据时遇到了“文件结束”则返回EOF。

### 读取一整行

```c
#include<stdio.h>  
int main()  
{  
      char str[1024];  
      scanf("%[^\n]", &str);  
      ...  
      return 0;  
}
```

格式指令说明
format指向的字符串包含的格式指令由以下字符序列组成[4] ：
*
表示读入的数据将被舍弃。带有*的格式指令不对应可变参数列表中的任何数据。
域宽
以一个非零的十进制整数形式出现。表示该格式指令最多读入的字符数。
格式说明符
c 读入域宽指定的数目个字符组成的字符序列（后面不会加上空字节），如果省略宽度则读入单字符。如%c或%1c读入单字符，%2c读入两个字符（后面不会加上空字节），以此类推。
s读入一个的字符序列，后面会加上空字节，遇到空白字符(\t \r \n 空格等)完成读取。
d 读入可选有符号（可选有符号表示输入时可以带符号也可以不带符号，不带符号则视为非负）十进制整数。输入格式应该像strtol函数的base实参为10调用时识别的字符序列一样。
u 读入无符号符号十进制整数。输入格式应该像strtol函数的base实参为10调用时识别的字符序列一样。
i 读入可选有符号整数。输入格式应该像strtol函数的base实参为0调用时识别的字符序列一样。
a,e,f,g,A,E,F,G 读入可选有符号浮点数，输入格式应该像strtod函数识别的字符序列一样。
o 读入可选有符号八进制整数。输入格式应该像strtoul函数的base实参为8调用时识别的字符序列一样。
x,X读入可选有符号十六进制整数。输入格式应该像strtoul函数的base实参为16调用时识别的字符序列一样。
p 读入一个指针值。读入的字符序列应该与fprintf的%p产生的字符序列形式相同。
n 不读入任何字符，而是把到该位置已读入的字符数存储到与之对应的int*指向的位置。本转换说明符如果带有*或者带有域宽信息（如：%*n或%3n等），则后果是未定义的。
扫描字符集合
% 读入% 符号(百分号)
无效的转换说明符将引起未定义的行为。[5]
长度修饰符
hh与d, i, o, u, x, X, or n配合使用，表示对应一个signed char或unsigned char数据。
h与d, i, o, u, x, X, or n配合使用，表示对应一个short int或unsigned short int数据。
l 与d, i, o, u, x, X, or n配合使用，表示对应一个long int或unsigned long int数据；与a, A, e, E, f, F, g, or G配合使用表示对应一个double数据；与c,s,[配合使用表示对应wchar_t数据。
ll与d, i, o, u, x, X, or n配合使用，表示对应一个long long int或unsigned long long int数据。
j与d, i, o, u, x, X, or n配合使用，表示对应一个intmax_t或uintmax_t数据。
z与d, i, o, u, x, X, or n配合使用，表示对应一个size_t数据（或与size_t对应的有符号整型数据）。
t与d, i, o, u, x, X, or n配合使用，表示对应一个ptrdiff_t数据（或与ptrdiff_t对应的无符号整型数据）。
L 与a, A, e, E, f, F, g, or G配合使用，表示对应一个long double数据。
如果长度修饰符与格式说明符不匹配则引起未定义的行为。

（1）%s 表示读字符串，而 %d 表示读整数。格式串的处理顺序为从左到右，格式说明符逐一与变元表中的变元匹配。为了读取长整数，可以将 L / l 放在格式说明符的前面；为了读取短整数，可以将 h 放在格式说明符的前面。这些修饰符可以与 d、i、o、u 和 x 格式代码一起使用。
（2）默认情况下，a、f、e 和 g 告诉 scanf() 为 float 分配数据。 如果将 L / l放在这些修饰符的前面，则 scanf() 为 double 分配数据。使用 L 就是告诉 scanf()，接收数据的变量是 long double 型变量。
（3）如果使用的现代编译器程序支持 1995 年增加的宽字符特性， 则可以与 c 格式代码一起，用 l 修饰符说明类型 wchar_t 的宽字符指针；也可以与 s 格式代码一起，用 l 修饰符说明宽字符串的指针。l 修饰符也可以用于修饰扫描集，以说明宽字符。
（4）控制串中的空白符使 scanf() 在输入流中跳过一个或多个空白行。空白符可以是空格(space)、制表符(tab)和新行符(newline)。 本质上，控制串中的空白符使 scanf() 在输入流中读，但不保存结果，直到发现非空白字符为止。
（5）非空白符使 scanf() 在流中读一个匹配的字符并忽略之。例如，"%d,%d" 使 scanf() 先读入一个整数，读入中放弃逗号，然后读另一个整数。如未发现匹配，scanf() 返回。
（6）scanf() 中用于保存读入值的变元必须都是变量指针，即相应变量的地址。
（7）在输入流中，数据项必须由空格、制表符和新行符分割。逗号和分号等不是分隔符，比如以下代码：
scanf("%d%d",&r,&c);
将接受输入 10 20，但遇到 10,20 则失败。
（8）百分号(%)与格式符之间的星号(*)表示读指定类型的数据但不保存。因此，
scanf("%d%*c%d",&x,&y);
对 10/20 的读入操作中，10 放入变量 x，20 放入 y。
（9）格式命令可以说明最大域宽。 在百分号(%)与格式码之间的整数用于限制从对应域读入的最大字符数。例如，希望向 address 读入不多于 20 个字符时，可以书写成如下形式：
scanf("%20s",address);
如果输入流的内容多于 20 个字符，则下次 scanf() 从此次停止处开始读入。 若达到最大域宽前已遇到空白符，则对该域的读立即停止；此时，scanf() 跳到下一个域。
（10）虽然空格、制表符和新行符都用做域分割符号，但读单字符操作中却按一般字符处理。例如，对输入流 "x y" 调用：
scanf("%c%c%c",&a,&b,&c);
返回后，x 在变量 a 中，空格在变量 b 中，y 在变量 c 中。
注意，控制串中的其它字符，包括空格、制表符和新行符，都用于从输入流中匹配并放弃字符，被匹配的字符都放弃。例如，给定输入流 "10t20"，调用：
scanf("%dt%d",&x,&y);
将把 10 和 20 分别放到 x 和 y 中，t 被放弃，因为 t 在控制串中。
（11）ANSI C 标准向 scanf() 增加了一种新特性，称为扫描集(scanset)。 扫描集定义一个字符集合，可由 scanf() 读入其中允许的字符并赋给对应字符数组。 扫描集合由一对方括号中的一串字符定义，左方括号前必须缀以百分号。 例如，以下的扫描集使 scanf() 读入字符 A、B 和 C：
%[ABC]
使用扫描集时，scanf() 连续吃进集合中的字符并放入对应的字符数组，直到发现不在集合中的字符为止(即扫描集仅读匹配的字符)。返回时，数组中放置以 null 结尾、由读入字符组成的字符串。

用字符 ^ 可以说明补集。把 ^ 字符放为扫描集的第一字符时，构成其它字符组成的命令的补集合，指示 scanf() 只接受未说明的其它字符。
对于许多实现来说，用连字符可以说明一个范围（ISO C99标准没有规定）。例如，以下扫描集使 scanf() 接受字母 A 到 Z：
%[A-Z]
重要的是要注意扫描集是区分大小写的。因此，希望扫描大、小写字符时，应该分别说明大、小写字母。
（12） scanf() 返回等于成功赋值的域数的值，但由于星号修饰符而读入未赋值的域不计算在内。遇到文件结束则返回EOF；若出错则返回0。

一分钟了解scanf
79.8万 41"
scanf
计算机语言函数
本词条是多义词，共2个义项
展开
scanf()是C语言中的一个输入函数。与printf函数一样，都被声明在头文件stdio.h里，因此在使用scanf函数时要加上#include <stdio.h>。（在有一些实现中，printf函数与scanf函数在使用时可以不使用预编译命令#include 。）它是格式输入函数，即按用户指定的格式从键盘上把数据输入到指定的变量之中。

中文名
格式输入
外文名
Scan Format
外语缩写
scanf
应用学科
计算机科学
软件语言
C/C++
快速
导航
返回值

格式指令说明

空白字符和非空白字符

注意问题

发展
函数原型
int scanf(const char *restrict format,...);
函数 scanf() 是从标准输入流stdio[1] (标准输入设备，一般指向键盘)中读内容的通用子程序，可以说明的格式读入多个字符，并保存在对应地址的变量中。[2]
函数的第一个参数是格式字符串，它指定了输入的格式，并按照格式说明符解析输入对应位置的信息并存储于可变参数列表中对应的指针所指位置。每一个指针要求非空，并且与字符串中的格式符一一顺次对应。
返回值
scanf函数返回成功读入的数据项数，读入数据时遇到了“文件结束”则返回EOF。
如：
scanf("%d %d",&a,&b);
函数返回值为int型。如果a和b都被成功读入，那么scanf的返回值就是2；
如果只有a被成功读入，返回值为1；
如果a读取失败，返回值为0；
如果遇到错误或遇到end of file，返回值为EOF。end of file为Ctrl+z 或者Ctrl+d。
例：使用scanf函数输入数据。

# include <stdio.h>

int main(void)
{
    int a,b,c;
    printf("Give me the value of a,b,c seperated with whitespaces:\n");
    scanf("%d%d%d",&a,&b,&c);
    printf("a=%d,b=%d,c=%d\n",a,b,c);
    return 0;
}
&a,&b,&c中的&是寻址操作符，&a表示对象a在内存中的地址[3] ，是一个右值。变量a，b，c的地址是在编译阶段分配的（存储顺序由编译器决定）。
这里注意：如果scanf中%d是连着写的如“%d%d%d”,在输入数据时，数据之间不可以用逗号分隔，只能用空白字符（空格或tab键或者回车键）分隔——“2 （空格）3（tab） 4” 或 “2（tab）3（回车）4”等。若是“%d,%d,%d”，则在输入数据时需要加“,”，如“2,3,4”。
格式指令说明
format指向的字符串包含的格式指令由以下字符序列组成[4] ：
*
表示读入的数据将被舍弃。带有*的格式指令不对应可变参数列表中的任何数据。
域宽
以一个非零的十进制整数形式出现。表示该格式指令最多读入的字符数。
格式说明符
c 读入域宽指定的数目个字符组成的字符序列（后面不会加上空字节），如果省略宽度则读入单字符。如%c或%1c读入单字符，%2c读入两个字符（后面不会加上空字节），以此类推。
s读入一个的字符序列，后面会加上空字节，遇到空白字符(\t \r \n 空格等)完成读取。
d 读入可选有符号（可选有符号表示输入时可以带符号也可以不带符号，不带符号则视为非负）十进制整数。输入格式应该像strtol函数的base实参为10调用时识别的字符序列一样。
u 读入无符号符号十进制整数。输入格式应该像strtol函数的base实参为10调用时识别的字符序列一样。
i 读入可选有符号整数。输入格式应该像strtol函数的base实参为0调用时识别的字符序列一样。
a,e,f,g,A,E,F,G 读入可选有符号浮点数，输入格式应该像strtod函数识别的字符序列一样。
o 读入可选有符号八进制整数。输入格式应该像strtoul函数的base实参为8调用时识别的字符序列一样。
x,X读入可选有符号十六进制整数。输入格式应该像strtoul函数的base实参为16调用时识别的字符序列一样。
p 读入一个指针值。读入的字符序列应该与fprintf的%p产生的字符序列形式相同。
n 不读入任何字符，而是把到该位置已读入的字符数存储到与之对应的int*指向的位置。本转换说明符如果带有*或者带有域宽信息（如：%*n或%3n等），则后果是未定义的。
扫描字符集合
% 读入% 符号(百分号)
无效的转换说明符将引起未定义的行为。[5]
长度修饰符
hh与d, i, o, u, x, X, or n配合使用，表示对应一个signed char或unsigned char数据。
h与d, i, o, u, x, X, or n配合使用，表示对应一个short int或unsigned short int数据。
l 与d, i, o, u, x, X, or n配合使用，表示对应一个long int或unsigned long int数据；与a, A, e, E, f, F, g, or G配合使用表示对应一个double数据；与c,s,[配合使用表示对应wchar_t数据。
ll与d, i, o, u, x, X, or n配合使用，表示对应一个long long int或unsigned long long int数据。
j与d, i, o, u, x, X, or n配合使用，表示对应一个intmax_t或uintmax_t数据。
z与d, i, o, u, x, X, or n配合使用，表示对应一个size_t数据（或与size_t对应的有符号整型数据）。
t与d, i, o, u, x, X, or n配合使用，表示对应一个ptrdiff_t数据（或与ptrdiff_t对应的无符号整型数据）。
L 与a, A, e, E, f, F, g, or G配合使用，表示对应一个long double数据。
如果长度修饰符与格式说明符不匹配则引起未定义的行为。[6]
空白字符和非空白字符
空白字符
空白字符会使scanf函数在读操作中略去输入中的一个或多个空白字符。
非空白字符
一个非空白字符会使scanf()函数在读入时剔除掉与这个非空白字符相同的字符。
说明：
（1）%s 表示读字符串，而 %d 表示读整数。格式串的处理顺序为从左到右，格式说明符逐一与变元表中的变元匹配。为了读取长整数，可以将 L / l 放在格式说明符的前面；为了读取短整数，可以将 h 放在格式说明符的前面。这些修饰符可以与 d、i、o、u 和 x 格式代码一起使用。
（2）默认情况下，a、f、e 和 g 告诉 scanf() 为 float 分配数据。 如果将 L / l放在这些修饰符的前面，则 scanf() 为 double 分配数据。使用 L 就是告诉 scanf()，接收数据的变量是 long double 型变量。
（3）如果使用的现代编译器程序支持 1995 年增加的宽字符特性， 则可以与 c 格式代码一起，用 l 修饰符说明类型 wchar_t 的宽字符指针；也可以与 s 格式代码一起，用 l 修饰符说明宽字符串的指针。l 修饰符也可以用于修饰扫描集，以说明宽字符。
（4）控制串中的空白符使 scanf() 在输入流中跳过一个或多个空白行。空白符可以是空格(space)、制表符(tab)和新行符(newline)。 本质上，控制串中的空白符使 scanf() 在输入流中读，但不保存结果，直到发现非空白字符为止。
（5）非空白符使 scanf() 在流中读一个匹配的字符并忽略之。例如，"%d,%d" 使 scanf() 先读入一个整数，读入中放弃逗号，然后读另一个整数。如未发现匹配，scanf() 返回。
（6）scanf() 中用于保存读入值的变元必须都是变量指针，即相应变量的地址。
（7）在输入流中，数据项必须由空格、制表符和新行符分割。逗号和分号等不是分隔符，比如以下代码：
scanf("%d%d",&r,&c);
将接受输入 10 20，但遇到 10,20 则失败。
（8）百分号(%)与格式符之间的星号(*)表示读指定类型的数据但不保存。因此，
scanf("%d%*c%d",&x,&y);
对 10/20 的读入操作中，10 放入变量 x，20 放入 y。
（9）格式命令可以说明最大域宽。 在百分号(%)与格式码之间的整数用于限制从对应域读入的最大字符数。例如，希望向 address 读入不多于 20 个字符时，可以书写成如下形式：
scanf("%20s",address);
如果输入流的内容多于 20 个字符，则下次 scanf() 从此次停止处开始读入。 若达到最大域宽前已遇到空白符，则对该域的读立即停止；此时，scanf() 跳到下一个域。
（10）虽然空格、制表符和新行符都用做域分割符号，但读单字符操作中却按一般字符处理。例如，对输入流 "x y" 调用：
scanf("%c%c%c",&a,&b,&c);
返回后，x 在变量 a 中，空格在变量 b 中，y 在变量 c 中。
注意，控制串中的其它字符，包括空格、制表符和新行符，都用于从输入流中匹配并放弃字符，被匹配的字符都放弃。例如，给定输入流 "10t20"，调用：
scanf("%dt%d",&x,&y);
将把 10 和 20 分别放到 x 和 y 中，t 被放弃，因为 t 在控制串中。
（11）ANSI C 标准向 scanf() 增加了一种新特性，称为扫描集(scanset)。 扫描集定义一个字符集合，可由 scanf() 读入其中允许的字符并赋给对应字符数组。 扫描集合由一对方括号中的一串字符定义，左方括号前必须缀以百分号。 例如，以下的扫描集使 scanf() 读入字符 A、B 和 C：
%[ABC]
使用扫描集时，scanf() 连续吃进集合中的字符并放入对应的字符数组，直到发现不在集合中的字符为止(即扫描集仅读匹配的字符)。返回时，数组中放置以 null 结尾、由读入字符组成的字符串。
用字符 ^ 可以说明补集。把 ^ 字符放为扫描集的第一字符时，构成其它字符组成的命令的补集合，指示 scanf() 只接受未说明的其它字符。
对于许多实现来说，用连字符可以说明一个范围（ISO C99标准没有规定）。例如，以下扫描集使 scanf() 接受字母 A 到 Z：
%[A-Z]
重要的是要注意扫描集是区分大小写的。因此，希望扫描大、小写字符时，应该分别说明大、小写字母。
（12） scanf() 返回等于成功赋值的域数的值，但由于星号修饰符而读入未赋值的域不计算在内。遇到文件结束则返回EOF；若出错则返回0。
注意问题
（1）在高版本的 Visual Studio 编译器中，scanf 被认为是不安全的，被弃用，应当使用scanf_s代替 scanf。
（2） 对于字符串数组或字符串指针变量，由于数组名可以转换为数组和指针变量名本身就是地址，因此使用scanf()函数时，不需要在它们前面加上"&"操作符。
（3） 可以在格式化字符串中的"%"各格式化规定符之间加入一个整数，表示任何读操作中的最大位数。
（4） scanf函数中没有类似printf的精度控制。
如： scanf("%5.2f",&a); 是非法的。不能企图用此语句输入小数为2位的实数。
（5） scanf中要求给出变量地址，如给出变量名则会出错
如 scanf("%d",a);是非法的，应改为scanf("%d",&a);才是合法的。
（6） 在输入多个数值数据时，若格式控制串中没有非格式字符作输入数据之间的间隔,则可用空格，TAB或回车作间隔。
C编译在碰到空格，TAB，回车或非法数据(如对“%d”输入“12A”时，A即为非法数据)时即认为该数据结束。
（7） 在输入字符数据(%c)时，若格式控制串中无非格式字符，则认为所有输入的字符均为有效字符。
例如：
scanf("%c%c%c",&a,&b,&c);
输入为：
d e f
则把'd'赋予a, ' '（空格）赋予b,'e'赋予c。因为%c 只要求读入一个字符，后面不需要用空格作为两个字符的间隔，因此把' '作为下一个字符送给b。
只有当输入为：def（字符间无空格） 时，才能把'd'赋于a,'e'赋予b,'f'赋予c。 如果在格式控制中加入空格作为间隔，
如
scanf("%c %c %c",&a,&b,&c);
则输入时各数据之间可加空格。
我们用一些例子来说明一些规则:

# include<stdio.h>

int main(void)
{
char a,b;
printf("input character a,b\n");
scanf("%c%c",&a,&b);/*注意两个%c之间没有任何符号*/
printf("%c%c\n",a,b);
return 0;
}
由于scanf函数"%c%c"中没有空格，输入M N，结果输出只有M。而输入改为MN时则可输出MN两字符，见下面的输入运行情况： input character a,b
输入：
MN
屏幕显示：
MN

# include <stdio.h>

int main(void)

{

char a,b;

printf("input character a,b\n");

scanf("%c %c",&a,&b);/*注意两个%c之间的空格*/

printf("\n%c%c\n",a,b);

return 0;

}
本例表示scanf格式控制串"%c %c"之间有空格时， 输入的数据之间可以有空格间隔。

## printf

printf 的格式控制字符串 format 中的转换说明组成如下，其中 [] 中的部分是可选的：[5]
%[flags][width][.precision][length]specifier，即：%[标志][最小宽度][.精度][类型长度]说明符[5] 。转换说明详解见下文。
